(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{286:function(s,a,t){"use strict";t.r(a);var e=t(14),n=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"_7、-dockerfile自动构建docker镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7、-dockerfile自动构建docker镜像"}},[s._v("#")]),s._v(" 7、 Dockerfile自动构建docker镜像")]),s._v(" "),a("p",[s._v("官方构建dockerffile文件参考:https://github.com/CentOS/CentOS-Dockerfiles")]),s._v(" "),a("h2",{attrs:{id:"_7-1-dockerfile指令集"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-1-dockerfile指令集"}},[s._v("#")]),s._v(" 7.1 Dockerfile指令集")]),s._v(" "),a("p",[s._v("dockerfile主要组成部分：")]),s._v(" "),a("blockquote",[a("p",[s._v('基础镜像信息 FROM centos:6.8\n制作镜像操作指令RUN yum insatll openssh-server -y\n容器启动时执行指令 CMD ["/bin/bash"]')])]),s._v(" "),a("p",[s._v("dockerfile常用指令：")]),s._v(" "),a("blockquote",[a("p",[s._v("FROM 这个镜像的妈妈是谁？（指定基础镜像）\nMAINTAINER 告诉别人，谁负责养它？（指定维护者信息，可以没有）\nRUN 你想让它干啥（在命令前面加上RUN即可）\nADD 给它点创业资金（COPY文件，会自动解压）\nWORKDIR 我是cd,今天刚化了妆（设置当前工作目录）\nVOLUME 给它一个存放行李的地方（设置卷，挂载主机目录）\nEXPOSE 它要打开的门是啥（指定对外的端口）\nCMD 奔跑吧，兄弟！（指定容器启动后的要干的事情）")])]),s._v(" "),a("p",[s._v("dockerfile其他指令：")]),s._v(" "),a("blockquote",[a("p",[s._v("COPY 复制文件\nENV 环境变量\nENTRYPOINT 容器启动后执行的命令")])]),s._v(" "),a("h2",{attrs:{id:"_7-2-创建一个dockerfile"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-2-创建一个dockerfile"}},[s._v("#")]),s._v(" 7.2 创建一个Dockerfile")]),s._v(" "),a("h3",{attrs:{id:"创建第一个dockerfile文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建第一个dockerfile文件"}},[s._v("#")]),s._v(" 创建第一个Dockerfile文件")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建目录")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker01 base"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd /opt/base")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建Dcokerfile文件，注意大小写")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker01 base"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim Dockerfile")]),s._v("\nFROM centos:6.8\nRUN yum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" openssh-server "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-y")]),s._v(" \nRUN "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"root:123456"')]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("chpasswd\nRUN /etc/init.d/sshd start \nCMD "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/usr/sbin/sshd"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-D"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("h3",{attrs:{id:"构建docker镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#构建docker镜像"}},[s._v("#")]),s._v(" 构建docker镜像")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker01 base"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker image build  -t centos6.8-ssh . ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-t")]),s._v(" 为镜像标签打标签  "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v(" 表示当前路径\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h3",{attrs:{id:"使用自构建的镜像启动"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用自构建的镜像启动"}},[s._v("#")]),s._v(" 使用自构建的镜像启动")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@docker01 base"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run  -d -p 2022:22 centos6.8-ssh-b ")]),s._v("\ndc3027d3c15dac881e8e2aeff80724216f3ac725f142daa66484f7cb5d074e7a\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h2",{attrs:{id:"_7-3-使用dcokerfile安装kodexplorer"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-3-使用dcokerfile安装kodexplorer"}},[s._v("#")]),s._v(" 7.3 使用Dcokerfile安装kodexplorer")]),s._v(" "),a("p",[s._v("Dockerfile文件内容")]),s._v(" "),a("div",{staticClass:"language-dockerfile line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-dockerfile"}},[a("code",[a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("FROM")]),s._v(" centos:6.8")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" yum install wget unzip php php-gd php-mbstring -y && yum clean all")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置工作目录，之后的操作都在这个目录中")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("WORKDIR")]),s._v(" /var/www/html/")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" wget -c http://static.kodcloud.com/update/download/kodexplorer4.25.zip")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" unzip kodexplorer4.25.zip && rm -f kodexplorer4.25.zip")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("RUN")]),s._v(" chown -R apache.apache .")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token instruction"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("CMD")]),s._v(" ["),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/usr/sbin/apachectl"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-D"')]),s._v(","),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"FOREGROUND"')]),s._v("]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("p",[s._v("更多的Dockerfile可以参考官方方法。")])])}),[],!1,null,null,null);a.default=n.exports}}]);